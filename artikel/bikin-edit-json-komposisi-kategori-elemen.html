<!DOCTYPE html>
<html lang="id">
<head> 
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Buat Edit JSON Komposisi Blok Kategori & Elemen</title>
  <link rel="canonical" href="https://mentarigroup.pages.dev/artikel/bikin-edit-json-komposisi-kategori-elemen.html">
  <link rel="icon" href="https://mentarigroup.pages.dev/favicon.ico" type="image/x-icon">
  <meta name="description" content="Edit dan buat file JSON untuk komposisi blok kategori dan elemen secara mudah. Solusi pengelolaan data yang efisien, praktis, dan terpadu.">
  <meta name="keywords" content="JSON, blok kategori, elemen, edit JSON, buat JSON, data struktur, mentarigroup">
  <meta name="author" content="Frijal">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://mentarigroup.pages.dev/artikel/bikin-edit-json-komposisi-kategori-elemen.html">
  <meta property="og:title" content="Buat Edit JSON Komposisi Blok Kategori & Elemen">
  <meta property="og:description" content="Edit dan buat file JSON untuk komposisi blok kategori dan elemen secara mudah. Solusi pengelolaan data yang efisien, praktis, dan terpadu.">
  <meta property="og:image" content="https://mentarigroup.pages.dev/img/bikin-edit-json-komposisi-kategori-elemen.webp">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Buat Edit JSON Komposisi Blok Kategori & Elemen">
  <meta name="twitter:description" content="Edit dan buat file JSON untuk komposisi blok kategori dan elemen secara mudah. Solusi pengelolaan data yang efisien, praktis, dan terpadu.">
  <meta name="twitter:image" content="https://mentarigroup.pages.dev/img/bikin-edit-json-komposisi-kategori-elemen.webp">
  <meta name="twitter:site" content="@mentarigroup">
  <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://mentarigroup.pages.dev/artikel/bikin-edit-json-komposisi-kategori-elemen.html","image":"https://mentarigroup.pages.dev/img/bikin-edit-json-komposisi-kategori-elemen.webp"},"headline":"Buat Edit JSON Komposisi Blok Kategori & Elemen","description":"Edit dan buat file JSON untuk komposisi blok kategori dan elemen secara mudah. Solusi pengelolaan data yang efisien, praktis, dan terpadu.","image":"https://mentarigroup.pages.dev/img/bikin-edit-json-komposisi-kategori-elemen.webp","author":{"@type":"Person","name":"Frijal","image":"https://mentarigroup.pages.dev/img/bikin-edit-json-komposisi-kategori-elemen.webp"},"publisher":{"@type":"Organization","name":"Frijal","logo":{"@type":"ImageObject","url":"https://mentarigroup.pages.dev/favicon.ico","image":"https://mentarigroup.pages.dev/img/bikin-edit-json-komposisi-kategori-elemen.webp"},"image":"https://mentarigroup.pages.dev/img/bikin-edit-json-komposisi-kategori-elemen.webp"},"datePublished":"2024-06-13","dateModified":"2024-06-13"}</script>
<style>
  /* --- Global & Typography --- */
  *,
  *::before,
  *::after {
    box-sizing: border-box;
  }

  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji";
    background-color: #f4f7f6;
    color: #333;
    margin: 0;
    padding: 24px;
    line-height: 1.5;
  }

  h1, h2, h3 {
    margin-top: 0;
    margin-bottom: 16px;
    font-weight: 600;
    line-height: 1.2;
  }

  h1 {
    font-size: 2.25rem;
    color: #2c3e50;
    margin-bottom: 24px;
  }

  h2 {
    font-size: 1.75rem;
    color: #34495e;
    border-bottom: 2px solid #ecf0f1;
    padding-bottom: 8px;
  }

  h3 {
    font-size: 1.25rem;
    color: #333;
  }

  p {
    margin-top: 0;
    margin-bottom: 16px;
    font-size: 1rem;
  }
  
  code {
    background: #ecf0f1;
    padding: 2px 6px;
    border-radius: 4px;
    font-family: Consolas, monaco, monospace;
  }
  
  hr {
    display: none;
  }
  
  /* --- Layout Card --- */
  .card {
    background: #ffffff;
    border-radius: 8px;
    padding: 24px;
    margin-bottom: 24px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
  }

  /* --- Form Inputs & Labels --- */
  label {
    display: block;
    margin-bottom: 6px;
    margin-top: 16px;
    font-weight: 500;
    color: #555;
  }

  input[type=text],
  input[type=date],
  textarea,
  input[type=file] {
    width: 100%;
    /* max-width: 600px; */ /* Dihapus agar bisa fluid di dalam flex */
    padding: 12px 14px;
    border: 1px solid #ddd;
    border-radius: 6px;
    font-size: 1rem;
    font-family: inherit;
    background-color: #fafafa;
    transition: border-color 0.2s, box-shadow 0.2s;
  }
  
  /* Override untuk input file di card pertama */
  .card:first-of-type input[type=file] {
      max-width: 600px;
  }
  
  /* Override untuk input nama kategori */
  #categoryName {
      max-width: 600px;
  }

  input[type=text]:focus,
  input[type=date]:focus,
  textarea:focus {
    outline: none;
    border-color: #3498db;
    box-shadow: 0 0 0 3px rgba(52, 152, 219, 0.2);
    background-color: #fff;
  }

  textarea {
    min-height: 80px;
    resize: vertical;
  }

  input[type=file] {
    padding: 10px;
    background: #fafafa;
    cursor: pointer;
  }

  input[type=file]::file-selector-button {
    padding: 8px 12px;
    border: none;
    border-radius: 4px;
    background-color: #34495e;
    color: white;
    cursor: pointer;
    margin-right: 12px;
    transition: background-color 0.2s;
  }
  
  input[type=file]::file-selector-button:hover {
    background-color: #2c3e50;
  }

  /* --- Buttons --- */
  button {
    padding: 12px 20px;
    font-size: 1rem;
    font-weight: 600;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.2s ease-in-out;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
  }

  button:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  }

  #generateJsonBtn {
    background-color: #2ecc71;
    color: white;
    font-size: 1.1rem;
    width: 100%;
    max-width: 600px;
    margin-top: 24px;
  }
  #generateJsonBtn:hover {
    background-color: #27ae60;
  }

  #addElementBtn {
    background-color: #3498db;
    color: white;
  }
  #addElementBtn:hover {
    background-color: #2980b9;
  }

  .remove-btn {
    position: absolute;
    top: 12px;
    right: 12px;
    background: #e74c3c;
    color: white;
    font-weight: bold;
    padding: 0;
    font-size: 1.25rem;
    line-height: 28px;
    width: 28px;
    height: 28px;
    border-radius: 50%;
    box-shadow: none;
    z-index: 20; /* Pastikan di atas preview */
  }
  .remove-btn:hover {
    background: #c0392b;
    transform: none;
    box-shadow: none;
  }

  /* --- Containers --- */
  .category-block {
    border: 1px solid #e0e0e0;
    margin-top: 24px;
    padding: 20px;
    background: #fdfdfd;
    border-radius: 8px;
  }

  .elements-list {
    margin-top: 16px;
  }

  /* --- (PERUBAHAN UTAMA) Elemen Row & Preview --- */
  .element-row {
    border: none; /* Pindahkan border ke flex container */
    padding: 0;
    margin-bottom: 16px;
    background: transparent; /* Pindahkan bg ke flex container */
    position: relative; /* Tetap relative untuk tombol hapus */
    border-radius: 8px;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.03);
    overflow: hidden; /* Untuk menjaga border-radius */
  }
  
  .element-row-flex {
    display: flex;
    flex-wrap: wrap; /* Agar responsif di layar kecil */
    border: 1px solid #e0e0e0;
    background: white;
  }

  .element-inputs {
    flex: 2; /* Kolom input mengambil 2 bagian */
    min-width: 300px; /* Lebar minimum sebelum wrapping */
    padding: 20px;
    padding-top: 24px;
    border-right: 1px solid #f0f0f0;
  }

  .element-preview {
    flex: 1; /* Kolom preview mengambil 1 bagian */
    min-width: 250px;
    padding: 20px;
    background: #fcfcfc;
    position: relative; /* Untuk menahan preview card */
  }

  .preview-card {
    border: 1px solid #e0e0e0;
    border-radius: 6px;
    background: #fff;
    overflow: hidden;
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.05);
    position: sticky; /* Tetap terlihat saat scroll kolom input */
    top: 20px;
  }
  
  .preview-image {
    width: 100%;
    height: 150px;
    object-fit: cover;
    background: #f0f0f0;
    color: #aaa;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 0.9rem;
  }
  
  .preview-content {
    padding: 16px;
  }

  .preview-title {
    font-size: 1.2rem;
    font-weight: 600;
    margin: 0 0 8px 0;
    color: #333;
    /* Batasi 2 baris */
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;  
    overflow: hidden;
    text-overflow: ellipsis;
  }
  
  .preview-desc {
    font-size: 0.9rem;
    color: #666;
    margin: 0 0 12px 0;
    /* Batasi 3 baris */
    display: -webkit-box;
    -webkit-line-clamp: 3;
    -webkit-box-orient: vertical;  
    overflow: hidden;
    text-overflow: ellipsis;
  }
  
  .preview-date {
    font-size: 0.8rem;
    font-weight: 500;
    color: #999;
  }
  
  /* --- Penyesuaian Label di Dalam Row --- */
  .element-inputs label {
    margin-top: 12px;
  }

  .element-inputs label:first-of-type {
    margin-top: 0;
  }
</style>
<meta property="og:image:alt" content="Buat Edit JSON Komposisi Blok Kategori & Elemen">
    <meta property="article:published_time" content="2025-10-25T05:51:04.726+00:00">
</head>
<body>

  <h1>Editor JSON Blok Kategori dan Elemen</h1>
<div id="iposbrowser"></div>

  <div class="card">
    <h2>1. Muat Data (Opsional)</h2>
    <p>Muat file JSON yang ada untuk mengedit atau menambah kategori.</p>
    <label for="loadJsonFile">Muat file <code>data_kategori.json</code>:</label>
    <input type="file" id="loadJsonFile" accept="application/json">
  </div>

  <div class="card">
    <h2>2. Edit atau Buat Kategori</h2>
    <div>
      <label for="categoryName">Pilih Kategori yang Ada atau Ketik Nama Baru:</label>
      <input type="text" id="categoryName" list="categoryList" placeholder="Pilih atau ketik nama kategori..." />
      <datalist id="categoryList"></datalist>
    </div>

    <div class="category-block">
      <h3>Data Elemen untuk Kategori Terpilih</h3>
      <div id="elementsContainer" class="elements-list">
        </div>
      <button id="addElementBtn">+ Tambah Elemen Baru</button>
    </div>

    <button id="generateJsonBtn">
      Generate & Download Updated JSON
    </button>
  </div>

  <script>
  // --- (PERUBAHAN) ---
  const BASE_URL = 'https://mentarigroup.pages.dev';
  // --- (AKHIR PERUBAHAN) ---

  let existingData = {};

  const elementsContainer = document.getElementById('elementsContainer');
  const addElementBtn = document.getElementById('addElementBtn');
  const generateJsonBtn = document.getElementById('generateJsonBtn');
  const categoryNameInput = document.getElementById('categoryName');
  const loadJsonFile = document.getElementById('loadJsonFile');
  const categoryList = document.getElementById('categoryList');

  // --- (FUNGSI BARU) ---
  function toAbsoluteUrl(url) {
    if (!url) return '';
    // Jika url adalah path relatif (dimulai dengan / tapi bukan //)
    if (url.startsWith('/') && !url.startsWith('//')) {
      return BASE_URL + url;
    }
    // Jika sudah absolut (http, https) atau path eksternal (//)
    return url;
  }
  
  function toRelativeUrl(url) {
    if (!url) return '';
    // Jika URL dimulai dengan BASE_URL, hapus
    if (url.startsWith(BASE_URL)) {
      return url.substring(BASE_URL.length);
    }
    // Jika tidak, kembalikan apa adanya (mungkin URL eksternal)
    return url;
  }
  // --- (AKHIR FUNGSI BARU) ---

  loadJsonFile.addEventListener('change', (event) => {
    const file = event.target.files[0];
    if (!file) return;

    const reader = new FileReader();
    reader.onload = (e) => {
      try {
        existingData = JSON.parse(e.target.result);
        populateCategoryList();
        categoryNameInput.value = '';
        elementsContainer.innerHTML = '';
        addElementBtn.click(); 
        alert('JSON berhasil dimuat! Pilih kategori dari daftar untuk diedit, atau ketik nama baru.');
      } catch (err) {
        alert('Error: File JSON tidak valid. ' + err.message);
        existingData = {}; 
      }
    };
    reader.onerror = () => {
      alert('Gagal membaca file.');
    };
    reader.readAsText(file);
  });

  function populateCategoryList() {
    categoryList.innerHTML = ''; 
    if (!existingData) return;
    for (const categoryName in existingData) {
      const option = document.createElement('option');
      option.value = categoryName;
      categoryList.appendChild(option);
    }
  }

  // --- FUNGSI BARU: Live Preview Update ---
  elementsContainer.addEventListener('input', (e) => {
    const input = e.target;
    const row = input.closest('.element-row');
    if (!row) return;

    const value = input.value;
    
    if (input.classList.contains('field-title')) {
      row.querySelector('.preview-title').textContent = value || 'Judul...';
    } 
    else if (input.classList.contains('field-desc')) {
      row.querySelector('.preview-desc').textContent = value || 'Deskripsi...';
    }
    else if (input.classList.contains('field-date')) {
      row.querySelector('.preview-date').textContent = value || 'Tanggal...';
    }
    else if (input.classList.contains('field-image')) {
      const imgEl = row.querySelector('.preview-image');
      const placeholder = 'https://via.placeholder.com/400x200.png?text=Image+Preview';
      
      // --- (PERUBAHAN) ---
      if (value) {
        // Gunakan URL absolut untuk preview
        imgEl.src = toAbsoluteUrl(value); 
      } else {
        imgEl.src = placeholder;
      }
      // --- (AKHIR PERUBAHAN) ---

      imgEl.onerror = () => {
        imgEl.src = placeholder;
        imgEl.onerror = null;
      };
    }
  });

  
  categoryNameInput.addEventListener('change', () => {
    const selectedCategory = categoryNameInput.value.trim();
    elementsContainer.innerHTML = ''; 

    if (existingData && existingData[selectedCategory]) {
      console.log(`Memuat data untuk kategori: ${selectedCategory}`);
      const elements = existingData[selectedCategory];
      if (elements.length > 0) {
        for (const el of elements) {
          const elData = {
            title: el[0],
            // --- (PERUBAHAN) ---
            // Ubah data yang dimuat menjadi relatif untuk diedit
            file: toRelativeUrl(el[1]),
            image: toRelativeUrl(el[2]),
            // --- (AKHIR PERUBAHAN) ---
            date: el[3], 
            desc: el[4]
          };
          elementsContainer.appendChild(createElementRow(elData));
        }
      } else {
        elementsContainer.appendChild(createElementRow());
      }
    } else {
      console.log(`Membuat baris baru untuk kategori baru: ${selectedCategory}`);
      elementsContainer.appendChild(createElementRow());
    }
  });

  // Fungsi buat satu baris input elemen baru
  function createElementRow(data = {}) {
    const div = document.createElement('div');
    div.classList.add('element-row');

    const dateValue = data.date ? data.date.substring(0, 10) : '';
    const placeholderImg = 'https://via.placeholder.com/400x200.png?text=Image+Preview';

    // --- (PERUBAHAN) ---
    // Data gambar (relatif) diubah jadi absolut HANYA untuk preview
    const imgSrc = escapeHtml(data.image ? toAbsoluteUrl(data.image) : placeholderImg);
    // --- (AKHIR PERUBAHAN) ---

    const titlePreview = escapeHtml(data.title || 'Judul...');
    const descPreview = escapeHtml(data.desc || 'Deskripsi...');
    const datePreview = dateValue || 'Tanggal...';

    div.innerHTML = `
      <button class="remove-btn" title="Hapus elemen ini">×</button>
      
      <div class="element-row-flex">
      
        <div class="element-inputs">
          <label>Judul:</label>
          <input type="text" class="field-title" placeholder="Judul elemen" value="${escapeHtml(data.title || '')}" required />
          
          <label>File HTML (nama file):</label>
                    <input type="text" class="field-file" placeholder="contoh: /artikel/halaman.html" value="${escapeHtml(data.file || '')}" required />
          
          <label>URL Gambar / Thumbnail:</label>
                    <input type="text" class="field-image" placeholder="contoh: /img/gambar.webp" value="${escapeHtml(data.image || '')}" />
          
          <label>Tanggal (ISO 8601):</label>
          <input type="date" class="field-date" value="${dateValue}" />
          
          <label>Deskripsi singkat:</label>
          <textarea class="field-desc" placeholder="Masukkan deskripsi singkat...">${escapeHtml(data.desc || '')}</textarea>
        </div>
        
        <div class="element-preview">
          <div class="preview-card">
                        <img class="preview-image" src="${imgSrc}" alt="Preview" onerror="this.src='${placeholderImg}'; this.onerror=null;" />
            <div class="preview-content">
              <h4 class="preview-title">${titlePreview}</h4>
              <p class="preview-desc">${descPreview}</p>
              <span class="preview-date">${datePreview}</span>
            </div>
          </div>
        </div>
        
      </div>     `;

    div.querySelector('.remove-btn').addEventListener('click', () => {
      if(confirm('Hapus elemen ini?')) {
        div.remove();
      }
    });

    return div;
  }

  function escapeHtml(text) {
    if (!text) return '';
    return text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g,"&quot;");
  }

  addElementBtn.addEventListener('click', () => {
    const newRow = createElementRow();
    elementsContainer.appendChild(newRow);
  });

  generateJsonBtn.addEventListener('click', () => {
    const categoryName = categoryNameInput.value.trim();
    if(!categoryName) {
      alert('Nama kategori harus diisi!');
      categoryNameInput.focus();
      return;
    }
    const elementDivs = [...elementsContainer.querySelectorAll('.element-row')];
    if(elementDivs.length === 0) {
      alert('Tambahkan minimal satu elemen!');
      return;
    }
    const elementsData = [];
    for(let div of elementDivs) {
      const title = div.querySelector('.field-title').value.trim();
      // --- (PERUBAHAN) ---
      // Ambil nilai relatif mentah dari input
      const fileRaw = div.querySelector('.field-file').value.trim();
      const imageRaw = div.querySelector('.field-image').value.trim();
      // --- (AKHIR PERUBAHAN) ---
      const date = div.querySelector('.field-date').value.trim();
      const desc = div.querySelector('.field-desc').value.trim();
      
      // Validasi menggunakan nilai mentah (relatif)
      if(!title || !fileRaw) { 
        alert('Judul dan File HTML harus diisi di semua elemen.');
        return;
      }

      // --- (PERUBAHAN) ---
      // Konversi ke URL absolut HANYA saat menyimpan
      const file = toAbsoluteUrl(fileRaw);
      const image = imageRaw ? toAbsoluteUrl(imageRaw) : ''; // Biarkan kosong jika input kosong
      // --- (AKHIR PERUBAHAN) ---

      const dateISO = date ? (new Date(date)).toISOString() : ""; 
      
      // Simpan nilai absolut ke JSON
      elementsData.push([title, file, image, dateISO, desc]);
    }
    existingData[categoryName] = elementsData;
    const jsonStr = JSON.stringify(existingData, null, 2);
    downloadJSON(jsonStr, 'data_kategori_updated.json');
  });

  function downloadJSON(content, filename) {
    const blob = new Blob([content], {type: 'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    a.click();
    setTimeout(() => {
      URL.revokeObjectURL(url);
    }, 100);
  }

  window.addEventListener('load', () => {
    addElementBtn.click();
  });
  </script>
</body>
</html>
